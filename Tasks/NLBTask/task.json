{
	"id": "e94f1750-a6a8-11e6-be69-bdf37a7b15d8",
	"name": "NLBTask",
	"friendlyName": "NetworkLoadBalancer Task",
	"description": "Add/Remove a virtual machine's nic to the Load Balancer",
	"author": "Microsoft Corporation",
	"helpMarkDown": "Replace with markdown to show in help",
	"category": "Utility",
	"visibility": [
		"Build",
		"Release"
	],
    "runsOn": [
        "MachineGroup"
    ],
	"version": {
		"Major": "1",
		"Minor": "0",
		"Patch": "0"
	},
	"minimumAgentVersion": "1.95.0",
	"instanceNameFormat": "NLBTask: $(Operation)",
	"inputs": [
		{
			"name": "ConnectedServiceName",
            "type": "connectedService:AzureRM",
            "label": "AzureRM Subscription",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Select the Azure Resource Manager subscription for the deployment."
		}, 
		{
            "name": "ResourceGroupName",
            "type": "pickList",
            "label": "Resource Group",
            "required": true,
            "helpMarkDown": "Provide the name of the resource group.",
            "properties": {
                "EditableOptions": "True"
            }
        }, 
        {
        	"name": "LoadBalancer",
            "type": "pickList",
            "label": "Load Balancer Name",
            "required": true,
            "helpMarkDown": "Provide the name of the load balancer.",
            "properties": {
                "EditableOptions": "True"
            }
        }, 
        {
            "name": "Operation",
            "type": "pickList",
            "label": "Operation",
            "defaultValue": "",
            "required": true,
            "options": {
                "Remove": "Remove",
                "Add": "Add"
            },
            "helpMarkDown": "Select whether to add/remove VM from the load balancer"
        }
	],
	"dataSourceBindings": [
        {
            "target": "ResourceGroupName",
            "endpointId": "$(ConnectedServiceName)",
            "dataSourceName": "AzureResourceGroups"
        },
        {
            "target": "LoadBalancer",
            "endpointId": "$(ConnectedServiceName)",
            "dataSourceName": "AzureRMLoadBalancers",
            "parameters": {
                "ResourceGroupName": "$(ResourceGroupName)"
            }
        }
    ],
    "execution": {
		"Node": {
			"target": "nlbtask.js",
			"argumentFormat": ""
		}
	},
    "messages": {
        "CouldNotFetchNicDetails": "Could Not Fetch NIC Configuration details for the VM : %s",
        "NicDetailsFetched": "NIC Configuration Details obtained for VM : %s",
        "GettingAllNetworkInterfacesInTheResourceGroup": "Getting All Network Interfaces In The Resource Group : %s",
        "RequestingForAuthToken": "Requesting For Authorization Token : %s"
    }
}